#ifndef COMPONENT_H
#define COMPONENT_H

// c++-includes
#include <list>

// sfml-includes

// qt-includes

// user-includes
#include "object.h"
#include "tracker_ptr.h"
#include "json.hpp"

namespace gdf {
namespace kernel{

class ComponentContainer;

//////////////////////////////////////////////////////////////////////////////////////////////////////////
/// \brief The Component class is used to define a specific logic and add it to an object (\a ComponentContainer)
///
/// \note to be continued
class Component : public Object
{
    public:
        friend class ComponentContainer;

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief Default constructor
        ///
        Component();
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief Default destructor
        ~Component();
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

    public:
        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        void verbose();
        //////////////////////////////////////////////////////////////////////////////////////////////////////////



        virtual void on_gui();


    public:
        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief Initializes the Component, invoked at any time.
        ///
        virtual void init();
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief Initializes the Component, invoked after all scenes are built, used by only few sub-classes
        /// OBSOLETE: TO BE CHANGED
        virtual void post_init();
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief Update the component
        /// \param dt The elapsed amount of time between two calls
        ///
        virtual void update(sf::Time dt);
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        virtual void fixed_update(sf::Time dt);
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        virtual void late_update(sf::Time dt);
        //////////////////////////////////////////////////////////////////////////////////////////////////////////


        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        virtual void draw(sf::RenderTarget &target, sf::RenderStates states) const;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

    public:
        //Setters
        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        void set_host_object( ComponentContainer* ho);
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

    public:
        //Getters
        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        bool enabled() const;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief Cast the host object into a gameobject.
        /// \return a GameObject.
        ///
        gdf::kernel::GameObject* game_object() const;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief Retrieves a polymorphic type of the host object of type T
        ///
        /// \return A T casted type of host_object
        template< typename T >
        T* host_object();
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

    public:
        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        std::list<tracker_ptr<Component> > &children_components();
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        std::list<tracker_ptr<Component> > &parents_components();
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

    protected:
        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        bool enabled_ = true;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief Host object is a ComponentContainer the includes the Component
        ///
        ComponentContainer* host_object_ = nullptr;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief List of parent components this component depends on
        ///
        std::list< tracker_ptr<Component> > parents_components_;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

        //////////////////////////////////////////////////////////////////////////////////////////////////////////
        /// \brief List of children components that depends on this component
        ///
        std::list< tracker_ptr<Component> > children_components_;
        //////////////////////////////////////////////////////////////////////////////////////////////////////////

    public:
        std::string classname_ = "";

};

}}

#include "./component.inl"

#endif // COMPONENT_H
